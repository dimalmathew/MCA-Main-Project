{% extends 'ultimatix/admin/adminbase.html'%}
<!-- Latest compiled and minified CSS -->
{%block body %}
<style>
    .typo-agile{
        background: none;
    }
</style>
<h2 class="w3ls_head" style="margin-bottom: 0.5em;">Update Details</h2>
<div class="grid_3 grid_4 w3layouts ">
    <div class="bs-example">
        <div class="row">
            <form action="{% url 'ultimatix:updt_emp' 0 %}" method="post">
                {% csrf_token%}
                <div class="form-group row">
                    <div class="col-md-2"></div>
                        <div class="col-md-4">
                            <label for="eid">Employee Id</label>
                         </div>
                    <div class="col-md-4">
                        <input type="text" class="form-control" name="eid" id="eid" value="{{eobj.e_id}}" readonly>
                    </div>
                    <div class="col-md-2"></div>
                </div>
                <div class="panel-group">
                    <div class="panel panel-primary">
                        <div class="panel-heading"  style="text-align:left;">Personal Information</div>
                        <div class="panel-body">
                                {% if error %}
                                <div class="form-group row">
                                    <div class="col-md-2"></div>
                                    <div class="col-md-8">
                                        <div class="alert alert-danger" id="error">
                                            <strong>Danger!</strong>{{error}}
                                        </div>
                                    </div>
                                    <div class="col-md-2"></div>
                                </div>
                                {% elif success %}
                                <div class="form-group row">
                                    <div class="col-md-2"></div>
                                    <div class="col-md-8">
                                        <div class="alert alert-success" id="success">
                                            <strong>Success!</strong>{{success}}
                                        </div>
                                    </div>
                                    <div class="col-md-2"></div>
                                </div>
                                {%endif%}


                                <div class="form-group row">
                                    <div class="col-md-2"></div>
                                    <div class="col-md-4">
                                        <label for="fname">First Name</label>
                                        <input type="text" class="form-control" name="fname" id="fname" value="{{eobj.e_fname}}" disabled>
                                    </div>
                                    <div class="col-md-4">
                                            <label for="lname">Last Name</label>
                                            <input type="text" class="form-control" name="lname" id="lname" value="{{eobj.e_lname}}" required>
                                    </div>
                                    <div class="col-md-2"></div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-md-2"></div>
                                    <div class="col-md-4">
                                        <label for="surname">Father's Name</label>
                                        <input type="text" class="form-control" name="surname" id="surname" value="{{eobj.e_sname}}" required>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="dob">Date of Birth</label>
                                        <input type="date" class="form-control" name="dob" id="dob" disabled required>
                                    </div>
                                    <div class="col-md-2"></div>
                                </div>
                                <div class="form-group row">
                                    <div class="col-md-2"></div>
                                    <div class="col-md-4">
                                        <label for="bgroup">Blood Group</label>
                                        <select  title="Choose Blood Group" class="form-control" name="bgroup" id="bgroup" >
						                    <!--<option>Choose Blood Group</option>-->
                                            <option>A+</option>
                                            <option>A-</option>
                                            <option>B+</option>
                                            <option>B-</option>
                                            <option>AB+</option>
                                            <option>AB-</option>
                                            <option>O+</option>
                                            <option>O-</option>
						                </select>
                                    </div>
                                    <div class="col-md-4">
                                        <label for="mstatus">Marital Status</label>
                                        <select  title="Choose Marital Status" class="form-control" name="mstatus" id="mstatus" >
                                        <!--<option>Choose Marital Status</option>-->
                                        <option value="S">Single</option>
                                        <option value="M">Married</option>
                                        <option value="W">Widowed</option>
                                        <option value="D">Divorced</option>
                                    </select>
                                    </div>
                                    <div class="col-md-2"></div>
                                </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">

                                    <label for="nationality">Nationality</label>
                                    <input type="text" class="form-control" name="nationality" id="nationality" value="{{eobj.e_nationality}}" disabled>
                                </div>
                                <div class="col-md-4">

                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <div class="checkbox">
                                        <label for="chk_disb">
                                        <input type="checkbox" value="Y" id="chk_disb" name="chk_disb">
                                        <b>Disabled</b>
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-4">

                                    <label for="male">Male</label>
                                    <input type="radio" name="gender" id="male" value="M" checked disabled>
                                    <label for="female">Female</label>
                                    <input type="radio" name="gender" id="female" value="F" disabled>
                                </div>
                                <div class="col-md-2"></div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="panel-group">
                    <div class="panel panel-primary">
                        <div class="panel-heading"  style="text-align:left;">Contact Information</div>
                        <div class="panel-body">

                            <div class="form-group row">
                                <!--<div class="col-md-2"></div>-->
                                <div class="col-md-5">
                                    <div class="panel-group">
                                        <div class="panel panel-default">
                                            <div class="panel-heading"  style="text-align:left;">Permanent Address</div>
                                            <div class="panel-body">
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="paddr1">Address Line 1</label>
                                                        <input type="text" class="form-control" name="paddr1" id="paddr1" value="{{eobj.e_paddr1}}" required>
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="paddr2">Address Line 2</label>
                                                        <input type="text" class="form-control" name="paddr2" id="paddr2" value="{{eobj.e_paddr2}}" required>
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="paddr3">Address Line 3</label>
                                                        <input type="text" class="form-control" name="paddr3" id="paddr3" value="{{eobj.e_paddr3}}">
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                            </div>
					                    </div>
				                    </div>
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        <div class="checkbox">
                                            <label for="chk_addr">
                                                <input type="checkbox" value="Y" id="chk_addr" name="chk_addr">
                                                <b>Check if same</b>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <div class="panel-group">
                                        <div class="panel panel-default">
                                            <div class="panel-heading"  style="text-align:left;">Current Address</div>
                                            <div class="panel-body">
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="caddr1">Address Line 1</label>
                                                        <input type="text" class="form-control" name="caddr1" id="caddr1" value="{{eobj.e_caddr1}}">
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="caddr2">Address Line 2</label>
                                                        <input type="text" class="form-control" name="caddr2" id="caddr2" value="{{eobj.e_caddr2}}">
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                                <div class="row">
                                                    <div class="col-md-2"></div>
                                                    <div class="col-md-8">
                                                        <label for="caddr3">Address Line 3</label>
                                                        <input type="text" class="form-control" name="caddr3" id="caddr3" value="{{eobj.e_caddr3}}">
                                                    </div>
                                                    <div class="col-md-2"></div>
                                                </div>
                                            </div>
					                    </div>
				                    </div>
                                </div>
                                <!--<div class="col-md-2"></div>-->
                            </div>
                            <div class="form-group row">
                                <div class="col-md-1"></div>
                                <div class="col-md-5">
                                    <label for="email1">E-mail</label>
                                    <input type="email" class="form-control" name="email" id="email1" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" title="Please enter a valid email !" value="{{eobj.e_email}}" required>
                                </div>
                                <div class="col-md-5">
                                    <label for="mnumber">Mobile Number</label>
                                    <input type="text" class="form-control" name="mnumber" id="mnumber" pattern="(7|8|9)\d{9}" title="Please enter the 10 digit mobile number starts with 7/8/9 !" value="{{eobj.e_mnumber}}" required>
                                </div>
                                <div class="col-md-1"></div>
                            </div>
                        </div>
					</div>
				</div>
                <div class="panel-group">
                    <div class="panel panel-primary">
                        <div class="panel-heading"  style="text-align:left;">Professional Information</div>
                        <div class="panel-body">
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="doj">Date of Joining</label>
                                    <input type="date" class="form-control" name="doj" id="doj" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="qfn">Qualification</label>
                                    <input type="text" class="form-control" name="qfn" id="qfn" value="{{eobj.e_qfn}}"required>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="prev_exp">Previous Experience (in years)</label>
                                    <input type="number" class="form-control" name="prev_exp" id="prev_exp" step=".01" value="{{eobj.e_prev_exp}}" disabled>
                                </div>
                                <div class="col-md-4">
                                    <label for="prev_cmp">Previous Company</label>
                                    <input type="text" class="form-control" name="prev_cmp" id="prev_cmp" value="{{eobj.e_prev_cmp}}" disabled>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="desig_select">Employee Designation</label>
                                    <select  title="Choose Designation" class=" form-control" id="desig_select" name="desig_select" required>
						                <option>Choose Designation</option>
							                {% for obj in dobj %}
						                <option>{{obj.d_cd}}</option>
							                {% endfor %}
						                </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="salary">Salary (CTC)</label>
                                    <input type="number" class="form-control" name="salary" id="salary" step=".01" value="{{empsalobj.es_ctc}}" required>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-5"></div>
                                <div class="col-md-2">
                                    <button type="submit" class="btn btn-primary form-control" value="update" name="update" id="update" >Update</button>
                                </div>
                                <div class="col-md-5"></div>

                            </div>
                        </div>
					</div>
				</div>
            </form>
        </div>



    </div>
</div>


<script>
$(document).ready(function(){
	$('#emp').addClass("active");
	$('#view_emp').addClass("active");

    var s="{{eobj.e_dob}}";
    date=new Date(s);
    y = date.getFullYear();
    m = date.getMonth()+1;
    d = date.getDate();
    if (d < 10) {
    d = '0' + d;
    }
    if (m < 10) {
    m = '0' + m;
    }
    document.getElementById('dob').value = (y+'-' + m + '-'+d);

    var b="{{eobj.e_bgroup}}";
    if(b=='A+'){
    $('#bgroup')[0].selectedIndex = 0;
    }else if(b=='A-'){
          $('#bgroup')[0].selectedIndex = 1;
        }else if(b=='B+'){
              $('#bgroup')[0].selectedIndex = 2;
            }else if(b=='B-'){
                  $('#bgroup')[0].selectedIndex = 3;
				}else if(b=='AB+'){
					$('#bgroup')[0].selectedIndex = 4;
					}else if(b=='AB-'){
						$('#bgroup')[0].selectedIndex = 5;
						}else if(b=='O+'){
							$('#bgroup')[0].selectedIndex = 6;
							}else if(b=='O-'){
								$('#bgroup')[0].selectedIndex = 7;
								}


    var mst="{{eobj.e_mstatus}}";
    if(mst=='S'){
	$('#mstatus')[0].selectedIndex = 0;
	}else if(mst=='M'){
		$('#mstatus')[0].selectedIndex = 1;
		}else if(mst=='W'){
			$('#mstatus')[0].selectedIndex = 2;
			}else if(mst=='D'){
				$('#mstatus')[0].selectedIndex = 3;
				}


    var dis="{{eobj.e_disb}}"
    if(dis=='Y'){
    $('#chk_disb').prop('checked', true);
    $('#chk_disb').prop('disabled', true);
    }else{
        $('#chk_disb').prop('checked', false);
        }

    var gen="{{eobj.e_gender}}"
    if(gen=='M'){
    $("#male").prop("checked", true);
    $("#female").prop("checked", false);
    }else{
        $("#male").prop("checked", false);
        $("#female").prop("checked", true);
        }


    $("#chk_addr").click(function(){
       if ($('#chk_addr').is(":checked")){
           $('#caddr1').val($('#paddr1').val());
           $('#caddr2').val($('#paddr2').val());
           $('#caddr3').val($('#paddr3').val());
       }
       else{
           $('#caddr1').val('');
           $('#caddr2').val('');
           $('#caddr3').val('' );
       }
    });


    var s1="{{eobj.e_doj}}";
    date1=new Date(s1);
    y1 = date1.getFullYear();
    m1 = date1.getMonth()+1;
    d1 = date1.getDate();
    if (d1 < 10) {
    d1 = '0' + d1;
    }
    if (m1 < 10) {
    m1 = '0' + m1;
    }
    document.getElementById('doj').value = (y1+'-' + m1 + '-'+d1);

    $("#update").click(function(){
		var f=0;

        if($('#desig_select')[0].selectedIndex==0){
        alert('Please choose a designation for employee !');
		f=1;
        }
        if(f==1){
		event.preventDefault();
        }
    });


    var des="{{empdesobj.d_cd}}";
    var x= document.getElementById("desig_select");
    res=0;
    for(i=0; i<x.options.length;i++){
        if(x.options[i].value==des){
        res=i;
        }
    }
    $('#desig_select')[0].selectedIndex=res;

    	var imgurl="{{user.e_img.url}}";
	$('#user_img').attr('src',imgurl);

	        	var fname="{{user.e_fname}}";
    {% if user.e_lname %}
    var lname="{{user.e_lname}}";
    var flname=fname+" "+lname
    {%else%}
    var flname=fname;
    {% endif %}
    $('#username').text(flname);
});
</script>
{% endblock %}