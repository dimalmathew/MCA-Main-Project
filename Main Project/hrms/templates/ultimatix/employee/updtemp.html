{% extends 'ultimatix/employee/empbase.html'%}

{%block body %}
<style>
    .typo-agile{
        background: none;
        padding: 1em 2em 2em 2em;
    }
</style>
<!--<h2 class="w3ls_head" style="margin-bottom: 0.5em;">Update Employee Details</h2>-->
<div class="grid_3 grid_4 w3layouts">
    <div class="bs-example">
        <form action="{% url 'ultimatix:empdtlupdt'%}" method="post" id="empupdt_form" emp-update-url="{%url 'ultimatix:empdtlupdt' %}">
            {%csrf_token%}
            <!--<div class="form-group row">
                <div class="col-md-2"></div>
                <div class="col-md-4">
                    <label for="emp_select">Employee Id</label>
                </div>
                <div class="col-md-4">
                    <select  title="Choose Blood Group" class="form-control" name="emp_select" id="emp_select" >
                        <option>-Select-</option>
                        {%for o in emp_list%}
                        <option>{{o}}</option>
                        {%endfor%}
                    </select>
                </div>
                <div class="col-md-2"></div>
            </div>-->
            <div class="panel-group">
                <div class="panel panel-primary">
                    <div class="panel-heading"  style="text-align:left;">Personal Information</div>
                    <div class="panel-body">
                            {% if error %}
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-8">
                                    <div class="alert alert-danger" id="error">
                                        <strong>Danger!</strong>{{error}}
                                    </div>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            {% elif success %}
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-8">
                                    <div class="alert alert-success" id="success">
                                        <strong>Success!</strong>{{success}}
                                    </div>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            {%endif%}
                            <div class="form-group row">
                                <div class="col-md-4"></div>
                                <div class="col-md-4">
                                    <select  title="Choose Employee" class="form-control" name="emp_select" id="emp_select" >
                                        <option>- Select -</option>
                                        {%for o in emp_list%}
                                        <option>{{o}}</option>
                                        {%endfor%}
                                    </select>
                                </div>
                                <div class="col-md-4"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="fname">First Name</label>
                                    <input type="text" class="form-control" name="fname" id="fname"  disabled>
                                </div>
                                <div class="col-md-4">
                                        <label for="lname">Last Name</label>
                                        <input type="text" class="form-control" name="lname" id="lname" required>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="surname">Father's Name</label>
                                    <input type="text" class="form-control" name="surname" id="surname"  required>
                                </div>
                                <div class="col-md-4">
                                    <label for="dob">Date of Birth</label>
                                    <input type="date" class="form-control" name="dob" id="dob" disabled>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-2"></div>
                                <div class="col-md-4">
                                    <label for="bgroup">Blood Group</label>
                                    <select  title="Choose Blood Group" class="form-control" name="bgroup" id="bgroup" >
                                        <!--<option>Choose Blood Group</option>-->
                                        <option>A+</option>
                                        <option>A-</option>
                                        <option>B+</option>
                                        <option>B-</option>
                                        <option>AB+</option>
                                        <option>AB-</option>
                                        <option>O+</option>
                                        <option>O-</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label for="mstatus">Marital Status</label>
                                    <select  title="Choose Marital Status" class="form-control" name="mstatus" id="mstatus" >
                                    <!--<option>Choose Marital Status</option>-->
                                    <option value="S">Single</option>
                                    <option value="M">Married</option>
                                    <option value="W">Widowed</option>
                                    <option value="D">Divorced</option>
                                </select>
                                </div>
                                <div class="col-md-2"></div>
                            </div>
                        <div class="form-group row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">

                                <label for="nationality">Nationality</label>
                                <input type="text" class="form-control" name="nationality" id="nationality"  required>
                            </div>
                            <div class="col-md-4">
                                <label for="qualific">Qualification</label>
                                <input type="text" class="form-control" name="qualific" id="qualific" required>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-2"></div>
                            <div class="col-md-4">
                                <div class="checkbox">
                                    <label for="chk_disb">
                                    <input type="checkbox" value="Y" id="chk_disb" name="chk_disb">
                                    <b>Disabled</b>
                                    </label>
                                </div>
                            </div>
                            <div class="col-md-4">

                                <label for="male">Male</label>
                                <input type="radio" name="gender" id="male" value="M" checked disabled>
                                <label for="female">Female</label>
                                <input type="radio" name="gender" id="female" value="F" disabled>
                            </div>
                            <div class="col-md-2"></div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-4"></div>
                            <div class="col-md-4">
                                <button type="submit" class="btn btn-primary form-control" value="update" name="update" id="update" >Update</button>
                            </div>
                            <div class="col-md-4"></div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>
<script>
$(document).ready(function(){
	$('#employee').addClass("active");
	$('#emp_updt').addClass("active");

	$( "#emp_select" ).change(function() {
        var n=$("#emp_select")[0].selectedIndex;
        if(n==0){
        $('#fname').val("");
        $('#lname').val("");
        $('#surname').val("");
        $('#dob').val("");
        $('#bgroup')[0].selectedIndex = 0;
        $('#mstatus')[0].selectedIndex = 0;
        $('#nationality').val("");
        $('#qualific').val("");
        $('#chk_disb').prop('checked', false);
        $('#chk_disb').prop('disabled', false);
        $("#male").prop("checked", true);
        $("#female").prop("checked", false);
		}else{
		    var id=$("#emp_select").val();
            var url = $("#empupdt_form").attr("emp-update-url");

                $.ajax({
                url: url,
                method: 'GET',
                data: {
			        id: id
			    },
			    success: function(data){
                $('#fname').val(data[0].fname);
                $('#lname').val(data[0].lname);
                $('#surname').val(data[0].sname);
                $('#dob').val(data[0].dob);

                var b=data[0].bgroup;
                if(b=='A+'){
                $('#bgroup')[0].selectedIndex = 0;
                }else if(b=='A-'){
                      $('#bgroup')[0].selectedIndex = 1;
                    }else if(b=='B+'){
                          $('#bgroup')[0].selectedIndex = 2;
                        }else if(b=='B-'){
                              $('#bgroup')[0].selectedIndex = 3;
                            }else if(b=='AB+'){
                                $('#bgroup')[0].selectedIndex = 4;
                                }else if(b=='AB-'){
                                    $('#bgroup')[0].selectedIndex = 5;
                                    }else if(b=='O+'){
                                        $('#bgroup')[0].selectedIndex = 6;
                                        }else if(b=='O-'){
                                            $('#bgroup')[0].selectedIndex = 7;
                                            }
                var mst=data[0].mstatus;
                if(mst=='S'){
                $('#mstatus')[0].selectedIndex = 0;
                }else if(mst=='M'){
                    $('#mstatus')[0].selectedIndex = 1;
                    }else if(mst=='W'){
                        $('#mstatus')[0].selectedIndex = 2;
                        }else if(mst=='D'){
                            $('#mstatus')[0].selectedIndex = 3;
                            }

                $('#nationality').val(data[0].nationality);
                $('#qualific').val(data[0].qfn);

                var dis=data[0].disb;
                if(dis=='Y'){
                $('#chk_disb').prop('checked', true);
                $('#chk_disb').prop('disabled', true);
                }else{
                    $('#chk_disb').prop('checked', false);
                    $('#chk_disb').prop('disabled', false);
                    }

                var gen=data[0].gender;
                if(gen=='M'){
                $("#male").prop("checked", true);
                $("#female").prop("checked", false);
                }else{
                    $("#male").prop("checked", false);
                    $("#female").prop("checked", true);
                    }


			    }


            });
		}
	});

    $("#update").click(function(){
		var f=0;
        if($('#emp_select')[0].selectedIndex==0){
        alert('Please choose an employee!');
		f=1;
        }
        if(f==1){
		event.preventDefault();
        }
    });
});
</script>
{%endblock%}
